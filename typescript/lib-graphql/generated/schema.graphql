directive @oneOf on INPUT_OBJECT

type AccountOauth {
	"""
	unique identifier for the oauth provider. Don't use name of user because that could be changed
	"""
	id: String!
	displayName: String
	email: String
	emailVerified: Boolean!
	provider: OauthProvider!
	providerAccountId: OauthProvider!
	accessToken: String!
	refreshToken: String
	"""
	access token expiration timestamp, represented as the number of seconds since the epoch (January 1, 1970 00:00:00 UTC).
	"""
	expiresAt: DateTime
	tokenType: TokenType
	scopes: [String!]!
	idToken: String
	oauthToken: String
	oauthTokenSecret: String
}

input Address {
	street: String!
	houseNumber: String!
	city: String!
	zip: String!
}


"""
Implement the DateTime<Utc> scalar

The input/output is a string in RFC3339 format.
"""
scalar DateTime




type Mutation {
	createUser(userInput: UserInput!): UserCreateResult!
	signIn(signInCredentials: SignInCredentials!): UserSignInResult!
	signOut: UserSignOutResult!
	"""
	Creates a new user but doesn't log in the user
	Currently like this because of future developments
	"""
	signUp(user: UserInput!): UserCreateResult!
	createPost(post: PostInput!): Post!
}

enum OauthProvider {
	GITHUB
	GOOGLE
}

type Post {
	id: UUID
	posterId: UUID!
	title: String!
	content: String!
	poster: User!
}

input PostInput {
	title: String!
	content: String!
}

type Query {
	me: UserGetResult!
	user(id: UUID!): UserGetResult!
	getUser(userBy: UserBy!): UserGetResult!
	users: [User!]!
	session: Session!
	post(id: UUID!): Post!
	posts: [Post!]!
}

enum Role {
	ADMIN
	USER
}

type ServerError implements UserBaseError {
	message: String!
	solution: String!
}

type Session {
	userId: UUID!
	expiresAt: DateTime!
}

input SignInCredentials {
	username: String!
	password: String!
}

type SignOutMessage {
	message: String!
	userId: UUID!
}


type Subscription {
	values: Int!
}

enum TokenType {
	BEARER
}

"""
A UUID is a unique 128-bit number, stored as 16 octets. UUIDs are parsed as
Strings within GraphQL. UUIDs are used to assign unique identifiers to
entities without requiring a central allocating authority.

# References

* [Wikipedia: Universally Unique Identifier](http://en.wikipedia.org/wiki/Universally_unique_identifier)
* [RFC4122: A Universally Unique IDentifier (UUID) URN Namespace](http://tools.ietf.org/html/rfc4122)
"""
scalar UUID

type User {
	id: UUID
	createdAt: DateTime
	username: String!
	firstName: String
	lastName: String
	city: String
	email: String
	emailVerified: Boolean!
	age: Int
	socialMedia: [String!]!
	roles: [Role!]!
	accounts: [AccountOauth!]!
	posts: [Post!]!
	postCount: Int!
}

interface UserBaseError {
	message: String!
	solution: String!
}

input UserBy @oneOf {
	userId: UUID
	username: String
	address: Address
	email: String
}

union UserCreateResult = User | UserRegisterInvalidInputError | UserNotFoundError

type UserGenericError implements UserBaseError {
	title: String!
	message: String!
	solution: String!
	moreField: String!
}

union UserGetResult = User | UserRegisterInvalidInputError | UserNotFoundError

type UserHaveNoAccessError implements UserBaseError {
	title: String!
	message: String!
	solution: String!
	moreField: String!
}

input UserInput {
	username: String!
	password: String
	firstName: String
	lastName: String
	city: String
	email: String
	age: Int
	socialMedia: [String!]!
}

type UserNotFoundError implements UserBaseError {
	message: String!
	solution: String!
}

type UserRegisterInvalidInputError implements UserBaseError {
	message: String!
	title: String!
	solution: String!
	loginErrorMessage: String!
	emailErrorMessage: String!
	passwordErrorMessage: String!
}

type UserSessionExpiredError {
	message: String!
	solution: String!
}

type UserSignInInvalidInputError {
	message: String!
	title: String!
	solution: String!
	usernameErrorMessage: String!
	loginErrorMessage: String!
	emailErrorMessage: String!
	passwordErrorMessage: String!
}

union UserSignInResult = User | UserSignInInvalidInputError | UserNotFoundError

union UserSignOutResult = SignOutMessage | UserSessionExpiredError | ServerError

schema {
	query: Query
	mutation: Mutation
	subscription: Subscription
}
